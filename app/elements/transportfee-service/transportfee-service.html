<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<dom-module id="transportfee-service">
	<template>
		<iron-ajax
				method="post"
				id="generatefeeajax"
				url="{{generatefeeurl}}"
				params="{{generatefeeparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="generatefeeResponse"
				debounce-duration="300"
				>
	</iron-ajax>

	 <iron-ajax
				method="post"
				id="zonefeeajax"
				url="{{zonefeeurl}}"
				params="{{zonefeeparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="zonefeeResponse"
				debounce-duration="300"
				>
	</iron-ajax>

	 <iron-ajax
				method="post"
				id="getnameofstuajax"
				url="{{getnameofstuurl}}"
				params="{{getnameofstuparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="getnameofstuResponse"
				debounce-duration="300"
				>
	</iron-ajax>
	<iron-ajax
				method="post"
				id="payfeeajax"
				url="{{payfeeurl}}"
				 params="{{payfeeparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="payfeeResponse"
				debounce-duration="300"
				>
	</iron-ajax>
	 <iron-ajax
				method="post"
				id="chequedetailsajax"
				url="{{chequedetailsurl}}"
				 params="{{chequedetailsparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="chequedetailsResponse"
				debounce-duration="300"
				>
	</iron-ajax>

	 <iron-ajax
				method="post"
				id="payfee2ajax"
				url="{{payfee2url}}"
				 params="{{payfee2param}}"
				handle-as="json"
				content-type="application/json"
				on-response="payfee2Response"
				debounce-duration="300"
				>
	</iron-ajax>
	 <iron-ajax
				method="post"
				id="chequedetails2ajax"
				url="{{chequedetails2url}}"
				 params="{{chequedetails2param}}"
				handle-as="json"
				content-type="application/json"
				on-response="chequedetails2Response"
				debounce-duration="300"
				>
	</iron-ajax>
		<iron-ajax
				method="post"
				id="getfeedataajax"
				url="{{getfeedataurl}}"
				 params="{{getfeedataparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="getfeedataResponse"
				debounce-duration="300"
				>
	</iron-ajax>
	 <iron-ajax
				method="post"
				id="getfeezoneajax"
				url="{{getfeezoneurl}}"
				 params="{{getfeezoneparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="getfeezoneResponse"
				debounce-duration="300"
				>
	</iron-ajax>
	<iron-ajax
				method="post"
				id="getfeenameajax"
				url="{{getfeenameurl}}"
				 params="{{getfeenameparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="getfeenameResponse"
				debounce-duration="300"
				>
	</iron-ajax>
	 <iron-ajax
				method="post"
				id="sendrequestajax"
				url="{{sendrequesturl}}"
				 params="{{sendrequestparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="sendrequestResponse"
				debounce-duration="300"
				>
	</iron-ajax>
	<iron-ajax

				id="getinstalltypeajax"
				url="{{getinstalltypeurl}}"
				handle-as="json"
				content-type="application/json"
				on-response="getinstalltypeResponse"
				debounce-duration="300"
				>
	</iron-ajax>

	 <iron-ajax

				id="fetchinstalltypeajax"
				url="{{fetchinstalltypeurl}}"
				handle-as="json"
				content-type="application/json"
				on-response="fetchinstalltypeResponse"
				debounce-duration="300"
				>
	</iron-ajax>

	<iron-ajax

				id="zoneinstalltypeajax"
				url="{{zoneinstalltypeurl}}"
				handle-as="json"
				content-type="application/json"
				on-response="zoneinstalltypeResponse"
				debounce-duration="300"
				>
	</iron-ajax>

		<iron-ajax
				method="post"
				id="checkchequedetailsajax"
				url="{{checkchequedetailsurl}}"
				params="{{checkchequedetailsparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="checkchequedetailsResponse"
				debounce-duration="300"
				>
	</iron-ajax>
	 <iron-ajax
				method="post"
				id="checkchequebynameajax"
				url="{{checkchequebynameurl}}"
				params="{{checkchequebynameparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="checkchequebynameResponse"
				debounce-duration="300"
				>
	</iron-ajax>
	<iron-ajax
				method="post"
				id="bouncechequedetailsajax"
				url="{{bouncechequedetailsurl}}"
				params="{{bouncechequedetailsparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="bouncechequedetailsResponse"
				debounce-duration="300"
				>
	</iron-ajax>
	<iron-ajax
				method="post"
				id="updatechequedetailajax"
				url="{{updatechequedetailurl}}"
				 params="{{updatechequedetailparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="updatechequedetailResponse"
				debounce-duration="300"
				>
	</iron-ajax>
	<iron-ajax
				method="post"
				id="insertbouncechequeajax"
				url="{{insertbouncechequeurl}}"
				 params="{{insertbouncechequeparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="insertbouncechequeResponse"
				debounce-duration="300"
				>
	</iron-ajax>
	<iron-ajax
				method="post"
				id="bouncechequedetailajax"
				url="{{bouncechequedetailurl}}"
				 params="{{bouncechequedetailparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="bouncechequedetailResponse"
				debounce-duration="300"
				>
	</iron-ajax>
	 <iron-ajax
				method="post"
				id="updatestuchequeajax"
				url="{{updatestuchequeurl}}"
				 params="{{updatestuchequeparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="updatestuchequeResponse"
				debounce-duration="300"
				>
	</iron-ajax>
	 <iron-ajax
				method="post"
				id="datepickinsta1ajax"
				url="{{datepickinsta1url}}"
				params="{{datepickinsta1param}}"
				handle-as="json"
				content-type="application/json"
				on-response="datepickinsta1Response"
				debounce-duration="300"
				>
	</iron-ajax>
	 <iron-ajax
				method="post"
				id="datepickinsta1chequeajax"
				url="{{datepickinsta1chequeurl}}"
				params="{{datepickinsta1chequeparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="datepickinsta1chequeResponse"
				debounce-duration="300"
				>
	</iron-ajax>
	 <iron-ajax
				method="post"
				id="datepickinsta2ajax"
				url="{{datepickinsta2url}}"
				params="{{datepickinsta2param}}"
				handle-as="json"
				content-type="application/json"
				on-response="datepickResponse"
				debounce-duration="300"
				>
	</iron-ajax>
	 <iron-ajax
				method="post"
				id="datepickinsta2chequeajax"
				url="{{datepickinsta2chequeurl}}"
				params="{{datepickinsta2chequeparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="datepickchequeResponse"
				debounce-duration="300"
				>
	</iron-ajax>
	 <iron-ajax
				method="post"
				id="receiptseqajax"
				url="{{receiptsequrl}}"
				 params="{{receiptseqparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="receiptseqResponse"
				debounce-duration="300"
				>
	</iron-ajax>


<iron-ajax
				method="post"
				id="newreceiptseqajax"
				url="{{newreceiptsequrl}}"
				 params="{{newreceiptseqparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="newreceiptseqResponse"
				debounce-duration="300"
				>
	</iron-ajax>

 <iron-ajax
				method="post"
				id="feereportajax"
				url="{{feereporturl}}"
				 params="{{feereportparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="feereportResponse"
				debounce-duration="300"
				>
	</iron-ajax>


	<iron-ajax
				method="post"
				id="chequereportajax"
				url="{{chequereporturl}}"
				 params="{{chequereportparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="chequereportResponse"
				debounce-duration="300"
				>
	</iron-ajax>

	 <iron-ajax
				method="post"
				id="updatereceiptseqajax"
				url="{{updatereceiptsequrl}}"
				 params="{{updatereceiptparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="updatereceiptseqResponse"
				debounce-duration="300"
				>
	</iron-ajax>


	 <iron-ajax
				method="post"
				id="updatenewreceiptseqajax"
				url="{{updatenewreceiptsequrl}}"
				 params="{{updatenewreceiptparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="updatenewreceiptseqResponse"
				debounce-duration="300"
				>
	</iron-ajax>
<iron-ajax
				method="post"
				id="receiptnoajax"
				url="{{receiptnourl}}"
				 params="{{receiptnoparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="receiptnoResponse"
				debounce-duration="300"
				>
	</iron-ajax>
		<iron-ajax
				method="post"
				id="getstureceiptajax"
				url="{{getstureceipturl}}"
				 params="{{getstureceiptparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="getstureceiptResponse"
				debounce-duration="300"
				>
	</iron-ajax>
	<iron-ajax
				method="post"
				id="pendingajax"
				url="{{pendingurl}}"
				 params="{{pendingparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="pendingResponse"
				debounce-duration="300"
				>
	</iron-ajax>

	 <iron-ajax
				method="post"
				id="getreceiptinfoajax"
				url="{{getreceiptinfourl}}"
				 params="{{getreceiptinfoparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="getreceiptinfoResponse">
					</iron-ajax>
	<iron-ajax
				method="post"
				id="discountreportbynameajax"
				url="{{discountreportbynameurl}}"
				params="{{discountreportbynameparam}}"
				handle-as="json"
				content-type="application/json"
				on-response="discountreportbynameResponse"
				debounce-duration="300"
				>
	</iron-ajax>
		<iron-ajax
			method="post"
			id="feereport2ajax"
			url="{{feereport2url}}"
			params="{{feereport2param}}"
			handle-as="json"
			content-type="application/json"
			on-response="feereport2Response"
			debounce-duration="300"
		>
		</iron-ajax>


		<iron-ajax
			method="post"
			id="chequereport2ajax"
			url="{{chequereport2url}}"
			params="{{chequereport2param}}"
			handle-as="json"
			content-type="application/json"
			on-response="chequereport2Response"
			debounce-duration="300"
		>
		</iron-ajax>



		 <iron-ajax
			method="post"
			id="transportcancelajax"
			url="{{transportcancelurl}}"
			params="{{transportcancelparam}}"
			handle-as="json"
			content-type="application/json"
			on-response="transportcancelResponse"
			debounce-duration="300"
		>
		</iron-ajax>
		</template>

		 <script>
	(function() {
	var dademail;
		var zonename;
		var stuid;
		var feez="";
		var fromd;
		var tod;
		var studname;
		var feeresult;
		var uchequeno;
		var uchequestatus;
		var uinstalltype;
		var receiptcreate=[];
		var receiptid;
		//var feeresultinsta1;
		var collection1;
		var collection1cheque;
		var total_collection_cash;
		var collectreport=[];
		var recstudid;
		var dadname;
		var chenum;
		var chedate;
		var banknm;
		var feeresultinsta1;
		var feeresultinsta2;
		var feeresultinsta1cheque;
		var feeresultinsta2cheque;
		var cashcount;
		var chequecount;
		var rstudid;
		var chequearr=[];
		var todate;
		var todate1;
		var todate2;
var chequereportarr;
		var chequereportarr1;
var rpayfee;
var receiptseq;
var ackseq;
var rcount=0;
var paycount;
var bouncechequearr=[];
var bouncestuarr=[];
var installtype2date;
var newreceiptsequence;

		Polymer({
			is: "transportfee-service",
			FnClear:function(){
				dademail="";
		zonename="";
		stuid="";
		feez="";
		fromd="";
		tod="";
		studname="";
		feeresult="";
		uchequeno="";
		uchequestatus="";
		uinstalltype="";
		receiptcreate=[];
		receiptid="";
		feeresultinsta1="";
		collection1="";
		collection1cheque="";
		total_collection_cash="";
		collectreport=[];
		recstudid="";
		dadname="";
		chenum="";
		chedate="";
		banknm="";
		feeresultinsta1="";
		feeresultinsta2="";
		feeresultinsta1cheque="";
		feeresultinsta2cheque="";
		cashcount="";
		chequecount="";
		rstudid="";
		chequearr=[];
		todate="";
		chequereportarr="";
				chequereportarr1="";

			},
				generatefee:function(studid)

		 {

			this.generatefeeurl=sessionStorage.getItem("addrinfo")+"/reportfee-card";
				var obj={"studid":"","schol":"","academic_year":""}
				obj.studid=studid;
				obj.schol=sessionStorage.getItem("sch");
			    obj.academic_year=localStorage.getItem("curr_sess_academicyear");
            	this.generatefeeparam=obj;
				this.$.generatefeeajax.generateRequest();
				//alert(JSON.stringify(obj));
		 },
				zonefee:function(studid)
		 {

			this.zonefeeurl=sessionStorage.getItem("addrinfo")+"/zonefee-card";
				var obj={"studid":"","schol":""}
				obj.studid=studid;
				obj.schol=sessionStorage.getItem("sch");
				this.zonefeeparam=obj;
				this.$.zonefeeajax.generateRequest();
		 },
		 zonefeeResponse:function(e)
		 {
		 	//alert('2');
            feeresult=e.detail.response.returnval;
			 document.querySelector('transportfee-service').zoneinstalltype();
		 },
		 generatefeeResponse:function(e)
		 {
                  //alert(1);
			feeresult=e.detail.response.returnval;
			//alert(JSON.stringify(feeresult));
			document.querySelector('transportfee-card').feearr=feeresult;
			document.querySelector('transportfee-service').getinstalltype();
		 },
		 getnameofstu:function()
		 {

			this.getnameofstuurl=sessionStorage.getItem("addrinfo")+"/getnameofstu-card";
			var obj={"schol":"","academic_year":""}
		   	obj.schol=sessionStorage.getItem("sch");
		   //	alert(localStorage.getItem("curr_sess_academicyear"));
		    obj.academic_year=localStorage.getItem("curr_sess_academicyear");
            this.getnameofstuparam=obj;
		   	//alert(JSON.stringify(obj));

			 this.$.getnameofstuajax.generateRequest();
		 },
		 getnameofstuResponse:function(e)
		 {

			var nameitem=e.detail.response.returnval;
			//alert(JSON.stringify(nameitem));

			document.querySelector('transportfee-card').autocompletename(nameitem);
		 },
		 payfee:function(payfees)
		 {
			this.receiptsequrl=sessionStorage.getItem("addrinfo")+"/receiptsequence";
			var obj={"schol":""}
			obj.schol=sessionStorage.getItem("sch");
			this.receiptseqparam=obj;
			this.$.receiptseqajax.generateRequest();
			rpayfee=payfees;
		//	alert(JSON.stringify(rpayfee));
			paycount=payfees.length;

		 },
		 payfeeResponse:function(e)
		 {
				var pay1success=e.detail.response.returnval;
				if(pay1success=='success')
				{  rcount++;
						if(rcount==paycount)
						{
							document.querySelector('transportfee-service').generatereceipt();
							rcount=0;
						}
						//document.querySelector('zonetostudent-card').gotozone();

				}
			},
			generatereceipt:function()
			{

				this.updatereceiptsequrl=sessionStorage.getItem("addrinfo")+"/updatereceiptsequence";
				var obj={"schoolid":"","sequence":"","ackseq":""}
				obj.schoolid=sessionStorage.getItem("sch");
				obj.sequence =receiptseq;
				obj.ackseq=ackseq;
				this.updatereceiptparam =obj;
				this.$.updatereceiptseqajax.generateRequest();
			},
			receiptseqResponse:function(e)
			{
				var insdate;
				var receiptschoolid=e.detail.response.returnval[0].schoolid;
				 receiptseq=e.detail.response.returnval[0].sequence;
				 ackseq=e.detail.response.returnval[0].ackseq;
				 //var  instaldate=new Date();
				 //alert(instaldate);
				 var recdate=localStorage.getItem("localsess_receipt_date");
				 var condate = new Date(recdate);
				 //alert(condate);
				if(condate.getDate()<10)
				{
						insdate="0"+condate.getDate();
					 }
					 else
					 {
						insdate=condate.getDate();
					 }
				 
			 var insfromdate=condate.getFullYear()+"-"+(condate.getMonth()+1)+"-"+insdate;
			// alert(insfromdate);
				for(var i=0;i<rpayfee.length;i++)
				{
				if(rpayfee[i].paytype=="Cash"||rpayfee[i].paytype=="Transfer")
				{
				 this.payfeeurl=sessionStorage.getItem("addrinfo")+"/payfee-card";
				var obj={"studid":"","schol":"","installfee":"","paytype":"","instype":"","receiptno":"","fine":"","instdate":""}
				obj.studid=rpayfee[i].studid;
				obj.schol=sessionStorage.getItem("sch");
				obj.installfee=rpayfee[i].installamt;
				obj.paytype=rpayfee[i].paytype;
				obj.instype=rpayfee[i].installtype;
				obj.receiptno="REC16-17-"+receiptseq;
				obj.fine=rpayfee[i].fineamount;
				obj.instdate=insfromdate;
				this.payfeeparam=obj;
				receiptcreate.push(obj);
				this.$.payfeeajax.generateRequest();
				receiptseq++;
			}
			else
			{
				 this.payfeeurl=sessionStorage.getItem("addrinfo")+"/payfee-card";
				var obj={"studid":"","schol":"","installfee":"","paytype":"","instype":"","receiptno":"","fine":"","instdate":""}
				obj.studid=rpayfee[i].studid;
				obj.schol=sessionStorage.getItem("sch");
				obj.installfee=rpayfee[i].installamt;
				obj.paytype=rpayfee[i].paytype;
				obj.instype=rpayfee[i].installtype;
				 obj.fine=rpayfee[i].fineamount;
				obj.receiptno="ACK16-17-"+ackseq;
				//obj.totalfee=parseInt(rpayfee[i].installamt)+parseInt(rpayfee[i].fineamount);
				obj.instdate=insfromdate;
				this.payfeeparam=obj;
				receiptcreate.push(obj);
				this.$.payfeeajax.generateRequest();
				ackseq++;
			}

				}
			},
			updatereceiptseqResponse:function()
			{
				//alert('come');
				recstudid=receiptcreate[0].studid;
					this.getstureceipturl=sessionStorage.getItem("addrinfo")+"/getstureceipt";
					 var obj={"stid":"","schol":""}
						obj.stid=recstudid;
						obj.schol=sessionStorage.getItem("sch");
					 this.getstureceiptparam =obj;
				this.$.getstureceiptajax.generateRequest();
				this.getreceiptinfourl=sessionStorage.getItem("addrinfo")+"/getparentinfo";
					 this.getreceiptinfoparam =obj;
				this.$.getreceiptinfoajax.generateRequest();
		 },
		 getreceiptinfoResponse:function(e){
				dadname=e.detail.response.returnval[0].parent_name;
				dademail=e.detail.response.returnval[0].email;
				//alert(dademail);
				document.querySelector('receipt-card').parent=dadname;
				document.querySelector('receipt-card').parentemail=dademail;
				document.querySelector('cqreceipt-card').parent=dadname;
				document.querySelector('cqreceipt-card').parentemail=dademail;

			},
		 getstureceiptResponse:function(e)
		 {
			var title;
		var recarr1=[];
			var recarr=[];
			var cheqarr=[];
			var  getstu=e.detail.response.returnval;
			var recdate=localStorage.getItem("localsess_receipt_date");
			//alert(JSON.stringify(getstu));
			var dt=new Date(recdate);
			//var todate=dt.getDate()+"/"+(dt.getMonth()+1)+"/"+dt.getFullYear();
			var yr=dt.getFullYear()+' - '+(dt.getFullYear()+1);
			var m_names = new Array("Jan", "Feb", "Mar","Apr", "May", "Jun", "Jul", "Aug", "Sep","Oct", "Nov", "Dec");
			var curr_date = dt.getDate();
			var curr_month = dt.getMonth();
			var curr_year = dt.getFullYear();
			var todate = curr_date + "-" + m_names[curr_month]+ "-" + curr_year;
for(var i=0;i<receiptcreate.length;i++)
{
	document.querySelector('receipt-card').schoolname=sessionStorage.getItem("schoolname");
document.querySelector('receipt-card').schooladdr=sessionStorage.getItem("schooladdr");

	if(receiptcreate[i].instype=="installment1")
	{

var feezxc=receiptcreate[i].installfee;
//alert(receiptcreate[i].fine);
 var chword=document.querySelector('transport-service').convertrs(feezxc,receiptcreate[i].fine);
if(receiptcreate[i].paytype=="Cash")
{
title="RECEIPT";
}
else
{
	title="RECEIPT";
}

var recobj={"email":"","receiptid":"","studname":"","classname":"","section":"","installtype":"","installfee":"","paytype":"","receiptno":"","fine":""}
recobj.receiptno=receiptid;
recobj.studname=getstu[0].student_name;
recobj.classname=getstu[0].classname;
recobj.section=getstu[0].section;
recobj.installtype=receiptcreate[i].instype;
recobj.installfee=receiptcreate[i].installfee;
recobj.receiptno=receiptcreate[i].receiptno;
recobj.paytype=receiptcreate[i].paytype;
recobj.today=todate;
recobj.stid=recstudid;
recobj.session=yr;
recobj.parent=dadname;
recobj.email=dademail;
recobj.totalfee=parseInt(receiptcreate[i].installfee)+parseInt(receiptcreate[i].fine);
recobj.feeinword=chword;
recobj.fine=receiptcreate[i].fine;
recobj.schoolname=sessionStorage.getItem("schoolname");
recobj.schooladdr=sessionStorage.getItem("schooladdr");
recobj.title=title;
document.querySelector('receipt-card').schoolname=sessionStorage.getItem("schoolname");
document.querySelector('receipt-card').schooladdr=sessionStorage.getItem("schooladdr");
				var pt=receiptcreate[i].paytype;
			 if(pt=='Cheque'||pt=='Transfer')
			 {
				for(var j=0;j<chequearr.length;j++)
				{
					if(chequearr[j].installtype==receiptcreate[i].instype)
					{

						var cqobj={"cheno":"","cqdate":"","bknm":""}
						recobj.cheno=chequearr[j].chequenum;
						var dt=new Date(chequearr[j].chequedate);
						var m_names = new Array("Jan", "Feb", "Mar","Apr", "May", "Jun", "Jul", "Aug", "Sep","Oct", "Nov", "Dec");
						var curr_date = dt.getDate();
						var curr_month = dt.getMonth();
						var curr_year = dt.getFullYear();
						var todatez = curr_date + "-" + m_names[curr_month]+ "-" + curr_year;
						recobj.cqdate=todatez;
						recobj.bknm=chequearr[j].bankname;
						cheqarr.push(cqobj);
						document.querySelector('receipt-card').chequearray(cqobj);
						//document.querySelector('receipt-card').downloadpdf(recstudid);
					}
					}
				}
				recarr.push(recobj);
				document.querySelector('receipt-card').receiptarr=recarr;
			}
 else if(receiptcreate[i].instype=="installment2")
	{

		if(receiptcreate[i].paytype=="Cash"||receiptcreate[i].paytype=="Transfer")
{
title="RECEIPT";
}
else
{
	title="ACKNOWLEDGEMENT";
}
 var feeinw=receiptcreate[i].installfee;
 var chword1=document.querySelector('transport-service').convertrs(feeinw,receiptcreate[i].fine);
var recobj1={"receiptid":"","studname":"","classname":"","section":"","installtype":"","installfee":"","paytype":"","receiptno":"","fine":""}
recobj1.receiptno=receiptid;
recobj1.studname=getstu[0].student_name;
recobj1.classname=getstu[0].classname;
recobj1.section=getstu[0].section;
recobj1.installtype=receiptcreate[i].instype;
recobj1.installfee=receiptcreate[i].installfee;
recobj1.paytype=receiptcreate[i].paytype;
recobj1.receiptno=receiptcreate[i].receiptno;
recobj1.today=todate;
recobj1.stid=recstudid;
recobj1.fine=receiptcreate[i].fine;
recobj1.session=yr;
recobj1.parent=dadname;
recobj1.totalfee=parseInt(receiptcreate[i].installfee)+parseInt(receiptcreate[i].fine);
recobj1.feeinword=chword1;
recobj1.title=title;

			
					var pt1=receiptcreate[i].paytype;
			 if(pt1=='Cheque'||pt1=='Transfer')
			 {

				for(var j=0;j<chequearr.length;j++)
				{

					if(chequearr[j].installtype==recobj1.installtype)
					{
						var cqobj={"cheno":"","cqdate":"","bknm":""}
						recobj1.cheno=chequearr[j].chequenum;

						var dt=new Date(chequearr[j].chequedate);
						var m_names = new Array("Jan", "Feb", "Mar","Apr", "May", "Jun", "Jul", "Aug", "Sep","Oct", "Nov", "Dec");
						var curr_date = dt.getDate();
						var curr_month = dt.getMonth();
						var curr_year = dt.getFullYear();
						var todatez = curr_date + "-" + m_names[curr_month]+ "-" + curr_year;
						recobj1.cqdate=todatez;
						recobj1.bknm=chequearr[j].bankname;
						cheqarr.push(cqobj);
						document.querySelector('cqreceipt-card').chequearray(cqobj);
					}
					}
				}
				
				recarr1.push(recobj1);
				document.querySelector('cqreceipt-card').receiptarr=recarr1;
			document.querySelector('receipt-card').getinstall2(recarr1);
			}
}
				document.querySelector('transport-app').setPage("receipt","Fee Receipt");
		 },
		 chequeinfo:function(stdid,name,chequenum,bankname,chequedate,installtype)
		 {
			chenum=chequenum;
			chedate=chequedate;
			banknm=bankname;
			this.chequedetailsurl=sessionStorage.getItem("addrinfo")+"/chequedetails";
				var obj={"studid":"","name":"","chequenum":"","bankname":"","chequedate":"","installtype":"","chequestatus":"","schol":"","academic_year":""}
				obj.studid=stdid;
				obj.name=name;
				obj.chequenum=chequenum;
				obj.bankname=bankname;
				obj.chequedate=chequedate;
		        obj.installtype=installtype;
		   	    obj.chequestatus="processing";
			    obj.academic_year=localStorage.getItem("curr_sess_academicyear");
                obj.schol=sessionStorage.getItem("sch");
				this.chequedetailsparam=obj;
               chequearr.push(obj);
				this.$.chequedetailsajax.generateRequest();
        		 },
   chequedetailsResponse:function(e){
alert("Instalment Pay Successfully");
},

		 getfeedata:function(id)
		 {
			 this.getfeedataurl=sessionStorage.getItem("addrinfo")+"/getfeedata";
				var obj={"studid":"","schol":""}
				obj.studid=id;
				obj.schol=sessionStorage.getItem("sch");
				this.getfeedataparam=obj;
				this.$.getfeedataajax.generateRequest();
		 },
		 getfeedataResponse:function(e){
				//alert(JSON.stringify(e.detail.response.returnval));
				stuid=e.detail.response.returnval[0].student_id;
				var zonid=e.detail.response.returnval[0].zone_id,
				feez=e.detail.response.returnval[0].fees;
				document.querySelector('discountstudent-card').fees=feez;
				var fromdzxc=e.detail.response.returnval[0].from_date;
				var todzxc=e.detail.response.returnval[0].to_date;
				fromd=new Date(fromdzxc);
				tod=new Date(todzxc);


				this.getfeezoneurl=sessionStorage.getItem("addrinfo")+"/getfeezone";
				var obj={"zone":"","schol":""}
				obj.zone=zonid;
				obj.schol=sessionStorage.getItem("sch");
				this.getfeezoneparam=obj;
				this.$.getfeezoneajax.generateRequest();

			 //document.querySelector('transportfee-card').feearr=feeresult;
		 },
		 getfeezoneResponse:function(e){
				zonenam=e.detail.response.returnval[0].zone_name;

				this.getfeenameurl=sessionStorage.getItem("addrinfo")+"/getfeename";
				var obj={"sid":"","schol":""}
				obj.schol=sessionStorage.getItem("sch");
				obj.sid=stuid;
				this.getfeenameparam=obj;
				this.$.getfeenameajax.generateRequest();
		 },
		 getfeenameResponse:function(e){

				var studnam=e.detail.response.returnval[0].student_name;
				var schooltyp=e.detail.response.returnval[0].school_type;

				 var fromdatz=fromd.getFullYear()+"/"+(fromd.getMonth()+1)+"/"+fromd.getDate();
				var todatz=tod.getFullYear()+"/"+(tod.getMonth()+1)+"/"+tod.getDate();
				document.querySelector('discountstudent-card').id=stuid;
				document.querySelector('discountstudent-card').studname=studnam;
				document.querySelector('discountstudent-card').zonename=zonenam;
				document.querySelector('discountstudent-card').schooltype=schooltyp;

				document.querySelector('discountstudent-card').fromdate=fromdatz;
				document.querySelector('discountstudent-card').todate=todatz;

		 },
		 sendrequest:function(id,stuname,schooltypez,zonname,feesz,fromdatez,todatez,schooltypez,disamtz,reason){
				var toda=new Date();
				var fromdat=new Date(fromdatez);
				 var todat =new Date(todatez);
				var fromdatey=fromdat.getFullYear()+"/"+(fromdat.getMonth()+1)+"/"+fromdat.getDate();
				var todatey=todat.getFullYear()+"/"+(todat.getMonth()+1)+"/"+todat.getDate();
				var today=toda.getFullYear()+"/"+(toda.getMonth()+1)+"/"+toda.getDate();
			 this.sendrequesturl="http://localhost:8081/sendrequest";
				var obj={"stid":"","stname":"","schooltypezx":"","zoname":"","feesx":"","fromdatx":"","todatx":"","schooltypex":"","disamtx":"","reasonx":"","todayx":""}
				obj.stid=id;
				obj.stname=stuname;
				obj.schooltypezx=schooltypez;
				obj.zoname=zonname;
				obj.feesx=feesz;
				obj.fromdatx=fromdatey;
				obj.todatx=todatey;
				obj.schol=sessionStorage.getItem("sch");
				obj.disamtx=disamtz;
				obj.reasonx=reason;
				obj.todayx=today;
				this.sendrequestparam=obj;
				this.$.sendrequestajax.generateRequest();
		 },
		 sendrequestResponse:function(e){
				var result=e.detail.response.returnval;
				document.querySelector('discountstudent-card').discountrefresh();
				if(result=='success')
				{
						alert('Request sent');
				}
				else
				{
						alert('Request failed');
				}
		 },
		getinstalltype:function(){
				this.getinstalltypeurl="../../configfile/installmenttype.json";
				this.$.getinstalltypeajax.generateRequest();
	 	},
		zoneinstalltype:function(){
		this.zoneinstalltypeurl="../../configfile/installmenttype.json";
		this.$.zoneinstalltypeajax.generateRequest();
		
		},
		getinstalltypeResponse:function(e){
				var feepercent;
				var installarr=[];
				var install1fee;
				var install2fee;
				var install1date;
				var install2date;
				var discountfee;
				var feestudid;
				var mode1;
				var mode2;
				var feestudname;
				var date1;
				var date2;
				var install1status;
		  		var install2status;
				var install1fine;
				var install2fine;
				var dadname;
			

			feestudname=feeresult[0].student_name;
			feestudid=feeresult[0].id;
			discountfee=feeresult[0].discount_fee;
			feepercent=feeresult[0].fees;
			mode1=feeresult[0].modeofpayment1;
			mode2=feeresult[0].modeofpayment2;
			install1fee=feeresult[0].installment_1;
			install2fee=feeresult[0].installment_2;
			install1status=feeresult[0].install1_status;
			install2status=feeresult[0].install2_status;
			install1fine=feeresult[0].install1_fine;
			install2fine=feeresult[0].install2_fine;
			var d1=feeresult[0].installment_1Date;
			var totalfee=(parseInt(feepercent)-parseInt(discountfee));
			date1=new Date(d1);
			install1date=date1.getFullYear()+"/"+(date1.getMonth()+1)+"/"+date1.getDate();
			var d2=feeresult[0].installment_2Date;
			date2=new Date(d2);
			install2date=date2.getFullYear()+"/"+(date2.getMonth()+1)+"/"+date2.getDate();
				var installdata=e.detail.response;

				for(var i=0;i<installdata.length;i++)
				{
						 var paidstatus;
						 var paiddate;
						 var paymode;
						 var installstatus;
						 var fine;

						if(installdata[i].install_type=="installment1")
						{
								if(install1fee>0 && install1status!="bounce")
								{
								 paidstatus=true;
								 paiddate=install1date;
								 paymode=mode1;
								 installstatus=install1status;
								 fine=install1fine;
								 amt=install1fee;

								}
								else if(install1fee>0&&install1status=="bounce")
								{
									paidstatus=false;
										paiddate=installdata[i].paydate;
										paymode="";
										installstatus="";
										fine=install1fine;
										amt=install1fee;
								}
								else
								{
										paidstatus=false;
										paiddate=installdata[i].paydate;
										paymode="";
										installstatus="";
										fine=install1fine;
										amt=((parseInt(feepercent)-parseInt(discountfee))/100)*parseInt(installdata[i].amt_percentage);
										//amt=((parseInt(feepercent)-parseInt(discountfee))/100)*parseInt(installdata[i].amt_percentage)+parseInt(fine);

								}

						}
						 if(installdata[i].install_type=="installment2")
						{
								if(install2fee>0 && install2status!="bounce")
								{
								 paidstatus=true;
								 paiddate=install2date;
								 paymode=mode2;
								 installstatus=install2status;
								 fine=install2fine;
								 amt=install2fee;

								}
								else
								{
										paidstatus=false;
										paiddate=installdata[i].paydate;
										paymode="";
										installstatus="";
										fine=install2fine;
										amt=((parseInt(feepercent)-parseInt(discountfee))/100)*parseInt(installdata[i].amt_percentage);
										//amt=((parseInt(feepercent)-parseInt(discountfee))/100)*parseInt(installdata[i].amt_percentage)+parseInt(fine);
								}
								if(install1fee==(parseInt(feepercent)-parseInt(discountfee)))
								{
									 paidstatus=true;
									 amt="Nil";
								}
						}
						//alert(installdata[i].amt_percentage);
						var obj={"installtype":"","amount":"","paydate":"","paidstatus":"","installdate":"","paymentmode":"","feestudid":"","feestudname":"","installstatus":"","fineamt":""}
						obj.installtype=installdata[i].install_type;
						obj.amount=amt;
						obj.paydate=paiddate;
						//obj.installdate=paiddate;
						obj.paidstatus=paidstatus;
						obj.paymentmode=paymode;
						obj.feestudid=feestudid;
						obj.feestudname=feestudname;
						obj.installstatus=installstatus;
						obj.fineamt=fine;
						installarr.push(obj);
				}

			 if(install1fee<=0 && install2fee<=0)
			 {
				var allow=true;
				document.querySelector('transportfee-card').paymenttype(allow,installarr,feestudid,totalfee);
			 }
			 else
			 {
				var allow=false;
				document.querySelector('transportfee-card').paymenttype(allow,installarr,feestudid,totalfee);
			 }
document.querySelector('transportfee-card').installmentarr=installarr;

		 },
 zoneinstalltypeResponse:function(e){
				var feepercent;
				var installarr=[];
				var install1fee;
				var install2fee;
				var install1date;
				var install2date;
				var discountfee;
				var feestudid;
				var mode1;
				var mode2;
				var feestudname;
				var date1;
				var date2;
				var install1status;
				var install2status;
				var install1fine;
				var install2fine;
				var dadname;

			feestudname=feeresult[0].student_name;
			feestudid=feeresult[0].id;
			discountfee=feeresult[0].discount_fee;
			feepercent=feeresult[0].fees;
			mode1=feeresult[0].modeofpayment1;
			mode2=feeresult[0].modeofpayment2;
			install1fee=feeresult[0].installment_1;
			install2fee=feeresult[0].installment_2;
			install1status=feeresult[0].install1_status;
			install2status=feeresult[0].install2_status;
			install1fine=feeresult[0].install1_fine;
			install2fine=feeresult[0].install2_fine;
			var d1=feeresult[0].installment_1Date;
			date1=new Date(d1);
			install1date=date1.getFullYear()+"/"+(date1.getMonth()+1)+"/"+date1.getDate();


			var d2=feeresult[0].installment_2Date;
			date2=new Date(d2);
			install2date=date2.getFullYear()+"/"+(date2.getMonth()+1)+"/"+date2.getDate();
				var installdata=e.detail.response;
				//alert(feepercent+''+discountfee);
				for(var i=0;i<installdata.length;i++)
				{
						 var paidstatus;
						 var paiddate;
						 var paymode;
						 var installstatus;
						 var fine;
						//alert(feepercent);
						//alert(installdata[i].amt_percentage);
						if(installdata[i].install_type=="installment1")
						{
								if(install1fee>0 && install1status!="bounce")
								{
								 paidstatus=true;
								 paiddate=install1date;
								 paymode=mode1;
								 installstatus=install1status;
								 fine=install1fine;

								}
								else
								{
										paidstatus=false;
										paiddate="no";
										paymode="";
										installstatus="";
										fine=install1fine;

								}
						}
						 if(installdata[i].install_type=="installment2")
						{
								if(install2fee>0 && install2status!="bounce")
								{
								 paidstatus=true;
								 paiddate=install2date;
								 paymode=mode2;
								 installstatus=install2status;
								 fine=install2fine;

								}
								else
								{
										paidstatus=false;
										paiddate="no";
										paymode="";
										installstatus="";
										fine=install2fine;
								}
						}
						//alert(installdata[i].amt_percentage);
						var obj={"installtype":"","amount":"","paydate":"","paidstatus":"","installdate":"","paymentmode":"","feestudid":"","feestudname":"","installstatus":"","fineamt":""}
						obj.installtype=installdata[i].install_type;
					obj.amount=((parseInt(feepercent)-parseInt(discountfee))/100)*parseInt(installdata[i].amt_percentage);
					obj.fineamt=parseInt(fine);
						obj.paydate=installdata[i].paydate;
						obj.installdate=paiddate;
						obj.paidstatus=paidstatus;
						obj.paymentmode=paymode;
						obj.feestudid=feestudid;
						obj.feestudname=feestudname;
						obj.installstatus=installstatus;
						installarr.push(obj);
				}
				//alert(JSON.stringify(installarr));
document.querySelector('zonetostudent-card').installmentarr=installarr;
document.querySelector('zonetostudent-card').payoption(installarr);
		 },
		 bouncechequedetails:function()
		 {
			//alert('2');
				 this.bouncechequedetailsurl=sessionStorage.getItem("addrinfo")+"/bouncechequedetails";
				 var obj={"schol":"","academic_year":""}
				 		  obj.academic_year=localStorage.getItem("curr_sess_academicyear");
		    	   obj.schol=sessionStorage.getItem("sch");
					 this.bouncechequedetailsparam =obj;
				this.$.bouncechequedetailsajax.generateRequest();
		 },
		bouncechequedetailsResponse:function(e)
		 {
var bouncechequearr=e.detail.response.returnval;
//alert(JSON.stringify(bouncechequearr));
document.querySelector('bouncecheque-card').bchequearr=bouncechequearr;
		 },

		 checkchequedetails:function(chequefromdate,chequetodate)
		 {
			var d;
			var m;
			var d1;
			var m1;

			// alert('2'+chequefromdate+''+chequetodate);
			 var condate = new Date(chequefromdate);
				if(condate.getDate()<10)
				{
						 d="0"+condate.getDate();
					 }
					 else
					 {
						d=condate.getDate();
					 }
					if((condate.getMonth()+1)<10)
					{
						 m="0"+(condate.getMonth()+1);
					}
					else
					{
					m=condate.getMonth()+1;
					}
			 var cfromdate=m+"/"+d+"/"+condate.getFullYear();
				var condate2 = new Date(chequetodate);
				 if(condate2.getDate()<10)
				{
						 d1="0"+condate2.getDate();
					 }
					 else
					 {
						d1=condate2.getDate();
					 }
					if((condate2.getMonth()+1)<10)
					{
						 m1="0"+(condate2.getMonth()+1);
					}  
					else
					{
					m1=condate2.getMonth()+1;
					}
			 var ctodate=m1+"/"+d1+"/"+condate2.getFullYear();
				 this.checkchequedetailsurl=sessionStorage.getItem("addrinfo")+"/checkchequedetails";
				 var obj={"schol":"","fromdate":"","todate1":"","academic_year":""};

						obj.schol=sessionStorage.getItem("sch");
						  obj.academic_year=localStorage.getItem("curr_sess_academicyear");
		    				obj.fromdate=cfromdate;
						obj.todate1=ctodate;
					 this.checkchequedetailsparam =obj;
				this.$.checkchequedetailsajax.generateRequest();
				
		 },
checkchequebyname:function(stnamee)
{
 // alert(stnamee);
 this.checkchequebynameurl=sessionStorage.getItem("addrinfo")+"/checkchequebyname";
				 var obj={"schol":"","stuname":"","academic_year":""}
				 	  obj.academic_year=localStorage.getItem("curr_sess_academicyear");

						obj.schol=sessionStorage.getItem("sch");
						obj.stuname=stnamee;
					 this.checkchequebynameparam =obj;
				this.$.checkchequebynameajax.generateRequest();
},
		 checkchequedetailsResponse:function(e)
		 {
		
				var chequedetailarr=[];
				var cstatus;
				var chequedetail=e.detail.response.returnval;

			// alert('s'+JSON.stringify(chequedetail));
				var d=new Date();
				for(var i=0;i<chequedetail.length;i++)
				{
						var d1=new Date(chequedetail[i].cheque_date);
						var mondiff=(d.getMonth()+1)-(d1.getMonth()+1);
						var daydiff=d.getDate()-d1.getDate();
						if(mondiff==0 && daydiff<=5)
						{
								cstatus="red";
						}
						else
						{
								cstatus="no";
						}
						var obj={"studid":"","sname":"","chequeno":"","bankname":"","cdate":"","cstatus":"","installtype":""}
						obj.studid=chequedetail[i].student_id;
						obj.sname=chequedetail[i].name;
						obj.chequeno=chequedetail[i].cheque_no;
						obj.bankname=chequedetail[i].bank_name;
						obj.cdate=chequedetail[i].cheque_date;
						obj.cstatus=cstatus;
						obj.installtype=chequedetail[i].installtype;
						chequedetailarr.push(obj);
				}

				document.querySelector('chequedetail-card').chequearr=chequedetailarr;
				document.querySelector('chequedetail-card').Fnchequedetail(chequedetail);

		 },
			checkchequebynameResponse:function(e)
		 {
		
				var chequedetailarr=[];
				var cstatus;
				var chequedetail=e.detail.response.returnval;

		 // alert('s'+JSON.stringify(chequedetail));
				var d=new Date();
				for(var i=0;i<chequedetail.length;i++)
				{
						var d1=new Date(chequedetail[i].cheque_date);
						var mondiff=(d.getMonth()+1)-(d1.getMonth()+1);
						var daydiff=d.getDate()-d1.getDate();
						if(mondiff==0 && daydiff<=5)
						{
								cstatus="red";
						}
						else
						{
								cstatus="no";
						}
						var obj={"studid":"","sname":"","chequeno":"","bankname":"","cdate":"","cstatus":"","installtype":""}
						obj.studid=chequedetail[i].student_id;
						obj.sname=chequedetail[i].name;
						obj.chequeno=chequedetail[i].cheque_no;
						obj.bankname=chequedetail[i].bank_name;
						obj.cdate=chequedetail[i].cheque_date;
						obj.cstatus=cstatus;
						obj.installtype=chequedetail[i].installtype;
						chequedetailarr.push(obj);
				}

				document.querySelector('chequedetail-card').chequearr=chequedetailarr;
				document.querySelector('chequedetail-card').Fnchequedetail(chequedetail);

		 },
		 updatechequedetail:function(chqdetail)
		 {
			

			 for(var i=0;i<chqdetail.length;i++)
				{
				uchequeno=chqdetail[i].cheque_no;
				uchequestatus=chqdetail[i].cheque_status;
				uinstalltype=chqdetail[i].installtype;
				 this.updatechequedetailurl=sessionStorage.getItem("addrinfo")+"/updatechequedetail";
				var obj={"chequestatus":"","chequenum":"","schol":"","academic_year":""}
		    	  obj.academic_year=localStorage.getItem("curr_sess_academicyear");
                obj.chequestatus=uchequestatus;
				obj.chequenum=uchequeno;
				obj.schol=sessionStorage.getItem("sch");

				this.updatechequedetailparam=obj;
				this.$.updatechequedetailajax.generateRequest();
			}
		 
		 },
		 generateseq:function()
		 {
			this.newreceiptsequrl=sessionStorage.getItem("addrinfo")+"/receiptsequence";
			var obj={"schol":""}
			obj.schol=sessionStorage.getItem("sch");
			this.newreceiptseqparam=obj;
			this.$.newreceiptseqajax.generateRequest();
		 },
		 newreceiptseqResponse:function(e)
		 {
			 newreceiptsequence=e.detail.response.returnval[0].sequence;
			 newacksequence=e.detail.response.returnval[0].ackseq;
			// alert(newreceiptsequence);
		 },
		 bouncechequedetail:function(chqdetail)
		 {
			 for(var i=0;i<chqdetail.length;i++)
				{
							 if(chqdetail[i].cheque_status=="bounce"||chqdetail[i].cheque_status=="cancelled")
							 {
								//alert('1come');
								this.bouncechequedetailurl=sessionStorage.getItem("addrinfo")+"/bouncechequedetail";
								var obj={"installtype":"","studid":"","schol":"","academic_year":""}
							  obj.academic_year=localStorage.getItem("curr_sess_academicyear");
                                obj.installtype=chqdetail[i].installtype;
								obj.studid=chqdetail[i].student_id;
								obj.schol=sessionStorage.getItem("sch");
								this.bouncechequedetailparam=obj;
								this.$.bouncechequedetailajax.generateRequest();
								bouncechequearr.push(chqdetail[i]);
							 }
				}
 //alert(JSON.stringify(bouncechequearr));
		 },
		 bouncechequedetailResponse:function(e)
		 {
		 // alert('2come');
		 bouncestuarr.push(e.detail.response.returnval[0]);
			var installamt;
			var installtyperep;
		 //alert(bouncechequearr.length+''+bouncestuarr.length);
		//alert('1'+JSON.stringify(bouncechequearr));
		 //alert('2'+JSON.stringify(bouncestuarr));
for(var l=0;l<bouncechequearr.length;l++)
{
	//alert('1');
	for(var m=0;m<bouncestuarr.length;m++)
	{
	 //alert('2');
		if(bouncechequearr[l].student_id==bouncestuarr[m].student_id)
		{
			//alert('3');
			if(bouncechequearr[l].installtype=="installment1")
			{
				//alert('4');
			 installamt=bouncestuarr[m].installment_1;
			 installtyperep=bouncestuarr[m].receipt_no1;
			}
			else
			{
				//alert('5');
				installamt=bouncestuarr[m].installment_2;
			 installtyperep=bouncestuarr[m].receipt_no2;
			}

			var ob={"std":"","schoolid":"","installtype":"","installamt":"","chequeno":"","bankname":"","chequedate":"","chequestatus":"","receiptno":"","academic_year":""}
			ob.std=bouncechequearr[l].student_id;
			ob.schoolid=sessionStorage.getItem("sch");
			ob.installtype=bouncechequearr[l].installtype;
			ob.installamt=installamt;
		    ob.academic_year=localStorage.getItem("curr_sess_academicyear");
            ob.chequeno=bouncechequearr[l].cheque_no;
			ob.bankname=bouncechequearr[l].bank_name;
			ob.chequedate= bouncechequearr[l].cheque_date;
			ob.chequestatus=bouncechequearr[l].cheque_status;
			ob.receiptno=installtyperep;
			//alert('3come');
			this.insertbouncechequeurl=sessionStorage.getItem("addrinfo")+"/insertbouncecheque";  
			this.insertbouncechequeparam=ob;
			this.$.insertbouncechequeajax.generateRequest();
		}
	}
}

		 //alert(JSON.stringify(bouncestuarr));
		 },
		 updatechequedetailResponse:function(e)
		 {
			
		 },
		 updatestudentcheque:function(chqdetail)
		 {

				var newreceipt;
				var newreceiptdate;
			//alert(JSON.stringify(chqdetail));
			 var paidstatus;
			 for(var j=0;j<chqdetail.length;j++)
				{

			 
				if(chqdetail[j].cheque_status=="cleared")
				{  var insdate;
					 var condate = new Date();
					//     alert(condate);
					 if(condate.getDate()<10)
					 {
						insdate="0"+condate.getDate();
					 }
					 else
					 {
						insdate=condate.getDate();
					 }
			//		alert(insdate);
				//	alert(condate);
				 
						var insfromdate=condate.getFullYear()+"-"+(condate.getMonth()+1)+"-"+insdate;
						paidstatus="paid";   
						newreceipt="REC16-17-"+newreceiptsequence;
						newreceiptsequence=parseInt(newreceiptsequence)+1;
					//	alert(insfromdate);
						newreceiptdate=insfromdate;
								}
				else if(chqdetail[j].cheque_status=="bounce")
				{

						paidstatus="bounce";
						newreceipt=null;
						newreceiptdate=null;
				}
				else if(chqdetail[j].cheque_status=="cancelled")
				{
					paidstatus="cancelled";
					newreceipt=null;
					newreceiptdate=null;
				}

				this.updatestuchequeurl=sessionStorage.getItem("addrinfo")+"/updatestucheque";
				var obj={"chequename":"","installtype":"","paidstatus":"","schol":"","receiptseq":"","newreceiptdate":"","academic_year":""}
				obj.schol=sessionStorage.getItem("sch");
			    obj.academic_year=localStorage.getItem("curr_sess_academicyear");
        		obj.chequename=chqdetail[j].student_id;
				obj.installtype=chqdetail[j].installtype;
				obj.paidstatus=paidstatus;
				obj.receiptseq=newreceipt;
				obj.newreceiptdate=newreceiptdate;
				this.updatestuchequeparam=obj;
				//alert(JSON.stringify(obj));
				this.$.updatestuchequeajax.generateRequest();
			}
			
			 this.updatenewreceiptsequrl=sessionStorage.getItem("addrinfo")+"/updatereceiptsequence";
				var obj={"schoolid":"","sequence":"","ackseq":""}
				obj.schoolid=sessionStorage.getItem("sch");
				obj.sequence =newreceiptsequence;
				obj.ackseq=newacksequence;
				this.updatenewreceiptparam =obj;
				this.$.updatenewreceiptseqajax.generateRequest();


		 },
		 updatestuchequeResponse:function(e)
		 {
			//alert('come');
			//document.querySelector('chequedetail-card').refreshchequedetail();

		 },
			feereport:function(dat)
			{
				var fdate;
				//alert(dat);
				var condate = new Date(dat);
				if(condate.getDate()<10)
				{
   fdate="0"+condate.getDate();
				}

				else
				{
					fdate=condate.getDate();
				}
				todate=condate.getFullYear()+"-"+(condate.getMonth()+1)+"-"+fdate;
				// alert(dat);
				//alert(todate);
				 this.chequereporturl=sessionStorage.getItem("addrinfo")+"/chequereport";
				var obj={"dates":"","schol":"","academic_year":""}
				    obj.academic_year=localStorage.getItem("curr_sess_academicyear");
        	
				obj.dates=todate;
				obj.schol=sessionStorage.getItem("sch");
				this.chequereportparam=obj;
				this.$.chequereportajax.generateRequest();
				this.feereporturl=sessionStorage.getItem("addrinfo")+"/feereport";
				var obj1={"dates":"","schol":"","academic_year":""}
				obj1.dates=todate;
			    obj1.academic_year=localStorage.getItem("curr_sess_academicyear");
        		obj1.schol=sessionStorage.getItem("sch");
				this.feereportparam=obj1;
				this.$.feereportajax.generateRequest();



			},
			feereport2:function(dat1,dat2)
			{
				var condate = new Date(dat1);
				todate1=condate.getFullYear()+"-"+(condate.getMonth()+1)+"-"+condate.getDate();
				var condate2 = new Date(dat2);
				todate2=condate2.getFullYear()+"-"+(condate2.getMonth()+1)+"-"+condate2.getDate();
				// alert(dat);
				//alert(todate);
				this.fetchinstalltypeurl="../../configfile/installmenttype.json";
				this.$.fetchinstalltypeajax.generateRequest();
				this.chequereport2url=sessionStorage.getItem("addrinfo")+"/chequereport2";
				var obj={"dates1":"","dates2":"","schol":""}
				obj.dates1=todate1;
				obj.dates2=todate2;
				obj.schol=sessionStorage.getItem("sch");
				this.chequereport2param=obj;
				//alert(JSON.stringify(obj));
				this.$.chequereport2ajax.generateRequest();
				this.feereport2url=sessionStorage.getItem("addrinfo")+"/feereport2";
				var obj1={"dates1":"","dates2":"","schol":""}
				obj1.dates1=todate1;
				obj1.dates2=todate2;
				obj1.schol=sessionStorage.getItem("sch");
				this.feereport2param=obj1;
				//alert(JSON.stringify(obj1));
				this.$.feereport2ajax.generateRequest();

			},
fetchinstalltypeResponse:function(e)
{
	var fetchdata=e.detail.response;
	for(var i=0;i<fetchdata.length;i++)
				{
						if(fetchdata[i].install_type=="installment2")
						{
							var condate = new Date(fetchdata[i].paydate);
				installtype2date=(condate.getMonth()+1)+"/"+condate.getDate()+"/"+condate.getFullYear();
						// installtype2date=fetchdata[i].paydate;
						}
					}
},
			chequereportResponse:function(e)
			{
				//alert("www");
				//alert(JSON.stringify(e.detail.response.returnval));
				chequereportarr=e.detail.response.returnval;

},
			chequereport2Response:function(e)
			{
				//alert(JSON.stringify(e.detail.response.returnval));
				chequereportarr1=e.detail.response.returnval;

			 // alert('cheque'+chequereportarr1.length);

			},
			feereportResponse:function(e){
				var feeinstall1arr=[];
				var feeinstall2arr=[];
				var chequeinstall1arr=[];
				var chequeinstall2arr=[];
			//	 alert(JSON.stringify(e.detail.response.returnval));
				 var feereports;
				 feereports=e.detail.response.returnval;
				 var cashcount=0;
				 var chequecount=0;
				 var cashtotal1=0;
				 var cashtotal2=0;
				 var chequetotal1=0;
				 var chequetotal2=0;

				 for(var i=0;i<feereports.length;i++)
				 {
					if(feereports[i].modeofpayment1=="Cash" && (feereports[i].installment_1Date==todate))
					{
						var obj={"student_id":"","name":"","receiptno":"","installment1":"","standard":"","section":""}
						obj.student_id=feereports[i].student_id;
						obj.name=feereports[i].name;
						obj.standard=feereports[i].standard;
						obj.section=feereports[i].section;
						obj.receiptno=feereports[i].receipt_no1;
						obj.installment1=feereports[i].installment_1;
						feeinstall1arr.push(obj);
						cashcount++;
						cashtotal1=parseInt(cashtotal1)+parseInt(feereports[i].installment_1);
					}

					if(feereports[i].modeofpayment2=="Cash" && feereports[i].installment_2Date==todate)
					{
						var obj3={"student_id":"","name":"","receiptno":"","installment2":"","standard":"","section":""}
						obj3.student_id=feereports[i].student_id;
						obj3.name=feereports[i].name;
						obj3.standard=feereports[i].standard;
						obj3.section=feereports[i].section;
						obj3.receiptno=feereports[i].receipt_no2;
						obj3.installment2=feereports[i].installment_2;
						feeinstall2arr.push(obj3);
						 cashcount++;
						 cashtotal2=parseInt(cashtotal2)+parseInt(feereports[i].installment_2);
					}



 if(feereports[i].modeofpayment1=="Cheque" && feereports[i].installment_1Date==todate)
					{
						//alert('2');
						chequecount++;
						for(var j=0;j<chequereportarr.length;j++)
						{
							if(chequereportarr[j].student_id==feereports[i].student_id && chequereportarr[j].installtype=="installment1")
							{
						var obj1={"student_id":"","name":"","receiptno":"","installment1":"","chequeno":"","bankname":"","chequedate":"","createddate":"","standard":"","section":""}
						obj1.student_id=feereports[i].student_id;
						obj1.name=feereports[i].name;
						obj1.standard=feereports[i].standard;
						obj1.section=feereports[i].section;
						obj1.receiptno=feereports[i].receipt_no1;
						obj1.installment1=feereports[i].installment_1;
						obj1.chequeno=chequereportarr[j].cheque_no;
						obj1.bankname=chequereportarr[j].bank_name;
						obj1.chequedate=chequereportarr[j].cheque_date;
						var dt1=new Date(feereports[i].installment_1Date);
						//var todate=dt.getDate()+"/"+(dt.getMonth()+1)+"/"+dt.getFullYear();
						var yr=dt1.getFullYear()+' - '+(dt1.getFullYear()+1);
						var m_names = new Array("Jan", "Feb", "Mar","Apr", "May", "Jun", "Jul", "Aug", "Sep","Oct", "Nov", "Dec");
						var curr_date = dt1.getDate();
						var curr_month = dt1.getMonth();
						var curr_year = dt1.getFullYear();
						var createddate1 = curr_date + "-" + m_names[curr_month]+ "-" + curr_year;
						obj1.createddate=createddate1;

						var dt2=new Date(chequereportarr[j].cheque_date);
						//var todate=dt.getDate()+"/"+(dt.getMonth()+1)+"/"+dt.getFullYear();
						var yr=dt2.getFullYear()+' - '+(dt2.getFullYear()+1);
						var m_names = new Array("Jan", "Feb", "Mar","Apr", "May", "Jun", "Jul", "Aug", "Sep","Oct", "Nov", "Dec");
						var curr_date = dt2.getDate();
						var curr_month = dt2.getMonth();
						var curr_year = dt2.getFullYear();
						var chequedate1 = curr_date + "-" + m_names[curr_month]+ "-" + curr_year;
						obj1.chequedate=chequedate1;
						chequeinstall1arr.push(obj1);
						chequetotal1=parseInt(chequetotal1)+parseInt(feereports[i].installment_1);
							}
						}
					}

 if(feereports[i].modeofpayment2=="Cheque" && feereports[i].installment_2Date==todate)
					{
						//   alert('1');
						chequecount++;
						for(var j=0;j<chequereportarr.length;j++)
						{
							if(chequereportarr[j].student_id==feereports[i].student_id && chequereportarr[j].installtype=="installment2")
							{


						var obj4={"student_id":"","name":"","receiptno":"","installment2":"","chequeno":"","bankname":"","chequedate":"","createddate":"","standard":"","section":""}
						obj4.student_id=feereports[i].student_id;
						obj4.name=feereports[i].name;
						obj4.standard=feereports[i].standard;
						obj4.section=feereports[i].section;
						obj4.receiptno=feereports[i].receipt_no2;
						obj4.installment2=feereports[i].installment_2;
						obj4.chequeno=chequereportarr[j].cheque_no;
						obj4.bankname=chequereportarr[j].bank_name;

						var dt3=new Date(feereports[i].installment_2Date);
						//var todate=dt.getDate()+"/"+(dt.getMonth()+1)+"/"+dt.getFullYear();
						var yr=dt3.getFullYear()+' - '+(dt3.getFullYear()+1);
						var m_names = new Array("Jan", "Feb", "Mar","Apr", "May", "Jun", "Jul", "Aug", "Sep","Oct", "Nov", "Dec");
						var curr_date = dt3.getDate();
						var curr_month = dt3.getMonth();
						var curr_year = dt3.getFullYear();
						var createddate2 = curr_date + "-" + m_names[curr_month]+ "-" + curr_year;
						obj4.createddate=createddate2;

						var dt4=new Date(chequereportarr[j].cheque_date);
						//var todate=dt.getDate()+"/"+(dt.getMonth()+1)+"/"+dt.getFullYear();
						var yr=dt4.getFullYear()+' - '+(dt4.getFullYear()+1);
						var m_names = new Array("Jan", "Feb", "Mar","Apr", "May", "Jun", "Jul", "Aug", "Sep","Oct", "Nov", "Dec");
						var curr_date = dt4.getDate();
						var curr_month = dt4.getMonth();
						var curr_year = dt4.getFullYear();
						var chequedate2 = curr_date + "-" + m_names[curr_month]+ "-" + curr_year;
						obj4.chequedate=chequedate2;
						chequeinstall2arr.push(obj4);
						 chequetotal2=parseInt(chequetotal2)+parseInt(feereports[i].installment_2);
							}
						}
					}


				}
	//alert(JSON.stringify(chequeinstall2arr));
    //alert(JSON.stringify(chequeinstall1arr));

document.querySelector('feereports-card').feereportarrcheque1=chequeinstall1arr;
document.querySelector('feereports-card').feereportarrcheque2=chequeinstall2arr;
document.querySelector('feereports-card').feereportarr1=feeinstall1arr;
document.querySelector('feereports-card').feereportarr2=feeinstall2arr;
document.querySelector('feereports-card').cash1=cashtotal1;
document.querySelector('feereports-card').cash2=cashtotal2;
document.querySelector('feereports-card').cheque1=chequetotal1;
document.querySelector('feereports-card').cheque2=chequetotal2;
document.querySelector('feereports-card').stucash=cashcount;
document.querySelector('feereports-card').stucheque=chequecount;
document.querySelector('feereports-card').totalpaid=parseInt(cashcount)+parseInt(chequecount);
document.querySelector('feereports-card').totalcash=parseInt(cashtotal1)+parseInt(cashtotal2);
document.querySelector('feereports-card').totalcheque=parseInt(chequetotal1)+parseInt(chequetotal2);
document.querySelector('feereports-card').totalcollection=parseInt(cashtotal1)+parseInt(cashtotal2)+parseInt(chequetotal1)+parseInt(chequetotal2);

			},
			feereport2Response:function(e){
				var feeinstall1arr=[];
				var feeinstall2arr=[];
				var chequeinstall1arr=[];
				var chequeinstall2arr=[];
				 //alert(JSON.stringify(e.detail.response.returnval));
				 var feereports;
				 feereports=e.detail.response.returnval;
				 //alert('total'+feereports.length);
				 var cashcount=0;
				 var chequecount1=0;
				 var chequecount2=0;
				 var cashtotal1=0;
				 var cashtotal2=0;
				 var chequetotal1=0;
				 var chequetotal2=0;
				 var chequecount3=0;
				 var pdccheque=0;
				 var install2cheque=0;

				 for(var i=0;i<feereports.length;i++)
				 {
					if(feereports[i].modeofpayment1=="Cash")
					{
						//alert('Cash installment1');
						var obj={"student_id":"","name":"","receiptno":"","installment1":"","standard":"","section":"","fine1":""}
						obj.student_id=feereports[i].student_id;
						obj.name=feereports[i].name;
						obj.standard=feereports[i].standard;
						obj.section=feereports[i].section;
						obj.receiptno=feereports[i].receipt_no1;
						obj.installment1=parseInt(feereports[i].installment_1);
						obj.fine1=parseInt(feereports[i].install1_fine);
						feeinstall1arr.push(obj);
						cashcount++;
						cashtotal1=parseInt(cashtotal1)+parseInt(feereports[i].installment_1)+parseInt(feereports[i].install1_fine);
					}

					if(feereports[i].modeofpayment2=="Cash")
					{
						var obj3={"student_id":"","name":"","receiptno":"","installment2":"","standard":"","section":"","fine2":""}
						obj3.student_id=feereports[i].student_id;
						obj3.name=feereports[i].name;
						obj3.standard=feereports[i].standard;
						obj3.section=feereports[i].section;
						obj3.receiptno=feereports[i].receipt_no2;
						obj3.installment2=parseInt(feereports[i].installment_2);
						obj3.fine2=parseInt(feereports[i].install2_fine);
						feeinstall2arr.push(obj3);
						cashcount++;
						cashtotal2=parseInt(cashtotal2)+parseInt(feereports[i].installment_2)+parseInt(feereports[i].install2_fine);
					}
          if(feereports[i].modeofpayment1=="Cheque")
					{
						
						for(var j=0;j<chequereportarr1.length;j++)
						{
							if(chequereportarr1[j].student_id==feereports[i].student_id && chequereportarr1[j].installtype=="installment1")
							{
								chequecount1++;
						var obj1={"student_id":"","name":"","receiptno":"","installment1":"","chequeno":"","bankname":"","chequedate":"","createddate":"","standard":"","section":"","fine1":""}
						obj1.student_id=feereports[i].student_id;
						obj1.name=feereports[i].name;
						obj1.standard=feereports[i].standard;
						obj1.section=feereports[i].section;
						obj1.receiptno=feereports[i].receipt_no1;
						obj1.installment1=parseInt(feereports[i].installment_1);
						obj1.fine1=parseInt(feereports[i].install1_fine);
						obj1.chequeno=chequereportarr1[j].cheque_no;
						obj1.bankname=chequereportarr1[j].bank_name;
						obj1.chequedate=chequereportarr1[j].cheque_date;
						var dt1=new Date(feereports[i].installment_1Date);
						var yr=dt1.getFullYear()+' - '+(dt1.getFullYear()+1);
						var m_names = new Array("Jan", "Feb", "Mar","Apr", "May", "Jun", "Jul", "Aug", "Sep","Oct", "Nov", "Dec");
						var curr_date = dt1.getDate();
						var curr_month = dt1.getMonth();
						var curr_year = dt1.getFullYear();
						var createddate1 = curr_date + "-" + m_names[curr_month]+ "-" + curr_year;
						obj1.createddate=createddate1;

						var dt2=new Date(chequereportarr1[j].cheque_date);
						//var todate=dt.getDate()+"/"+(dt.getMonth()+1)+"/"+dt.getFullYear();
						var yr=dt2.getFullYear()+' - '+(dt2.getFullYear()+1);
						var m_names = new Array("Jan", "Feb", "Mar","Apr", "May", "Jun", "Jul", "Aug", "Sep","Oct", "Nov", "Dec");
						var curr_date = dt2.getDate();
						var curr_month = dt2.getMonth();
						var curr_year = dt2.getFullYear();
						var chequedate1 = curr_date + "-" + m_names[curr_month]+ "-" + curr_year;
						obj1.chequedate=chequedate1;
						chequeinstall1arr.push(obj1);
						chequetotal1=parseInt(chequetotal1)+parseInt(feereports[i].installment_1)+parseInt(feereports[i].install1_fine);
							}
						}
					}

 if(feereports[i].modeofpayment2=="Cheque")
					{
					 
						for(var j=0;j<chequereportarr1.length;j++)
						{
							if(chequereportarr1[j].student_id==feereports[i].student_id && chequereportarr1[j].installtype=="installment2")
							{
								var condate = new Date(chequereportarr1[j].cheque_date);
				 var install2date=condate.getDate()+"/"+(condate.getMonth()+1)+"/"+condate.getFullYear();
								//alert(chequereportarr1[j].cheque_date+''+installtype2date)
								// alert(install2date+''+installtype2date);
if(install2date==installtype2date)
{
	//alert(install2date+''+installtype2date);
 chequecount2++;
 pdccheque=parseInt(pdccheque)+parseInt(feereports[i].installment_2);
}
else
{
	install2cheque=parseInt(install2cheque)+parseInt(feereports[i].installment_2);
	 chequecount3++;
}
						var obj4={"student_id":"","name":"","receiptno":"","installment2":"","chequeno":"","bankname":"","chequedate":"","createddate":"","standard":"","section":"","fine2":""}
						obj4.student_id=feereports[i].student_id;
						obj4.name=feereports[i].name;
						obj4.standard=feereports[i].standard;
						obj4.section=feereports[i].section;
						obj4.receiptno=feereports[i].receipt_no2;
						obj4.installment2=parseInt(feereports[i].installment_2);
						obj4.fine2=parseInt(feereports[i].install2_fine);
						obj4.chequeno=chequereportarr1[j].cheque_no;
						obj4.bankname=chequereportarr1[j].bank_name;

						var dt3=new Date(feereports[i].installment_2Date);
						//var todate=dt.getDate()+"/"+(dt.getMonth()+1)+"/"+dt.getFullYear();
						var yr=dt3.getFullYear()+' - '+(dt3.getFullYear()+1);
						var m_names = new Array("Jan", "Feb", "Mar","Apr", "May", "Jun", "Jul", "Aug", "Sep","Oct", "Nov", "Dec");
						var curr_date = dt3.getDate();
						var curr_month = dt3.getMonth();
						var curr_year = dt3.getFullYear();
						var createddate2 = curr_date + "-" + m_names[curr_month]+ "-" + curr_year;
						obj4.createddate=createddate2;

						var dt4=new Date(chequereportarr1[j].cheque_date);
						//var todate=dt.getDate()+"/"+(dt.getMonth()+1)+"/"+dt.getFullYear();
						var yr=dt4.getFullYear()+' - '+(dt4.getFullYear()+1);
						var m_names = new Array("Jan", "Feb", "Mar","Apr", "May", "Jun", "Jul", "Aug", "Sep","Oct", "Nov", "Dec");
						var curr_date = dt4.getDate();
						var curr_month = dt4.getMonth();
						var curr_year = dt4.getFullYear();
						var chequedate2 = curr_date + "-" + m_names[curr_month]+ "-" + curr_year;
						obj4.chequedate=chequedate2;
						chequeinstall2arr.push(obj4);
						 chequetotal2=parseInt(chequetotal2)+parseInt(feereports[i].installment_2)+parseInt(feereports[i].install2_fine);
							}
						}
					}


				}
   document.querySelector('feereports2-card').feereportarrcheque1=chequeinstall1arr;
document.querySelector('feereports2-card').feereportarrcheque2=chequeinstall2arr;
document.querySelector('feereports2-card').feereportarr1=feeinstall1arr;
document.querySelector('feereports2-card').feereportarr2=feeinstall2arr;
document.querySelector('feereports2-card').cash1=cashtotal1;
document.querySelector('feereports2-card').cash2=cashtotal2;
document.querySelector('feereports2-card').cheque1=chequetotal1;
document.querySelector('feereports2-card').cheque2=chequetotal2;
document.querySelector('feereports2-card').stucash=cashcount;
document.querySelector('feereports2-card').stucheque=chequecount1+chequecount2+chequecount3;
document.querySelector('feereports2-card').stucheque1=chequecount1;
document.querySelector('feereports2-card').stucheque2=chequecount2;
document.querySelector('feereports2-card').stucheque3=chequecount3;
document.querySelector('feereports2-card').stupdccheque=pdccheque;
document.querySelector('feereports2-card').stuinstall2cheque=install2cheque;
document.querySelector('feereports2-card').stuinstall1cheque=chequetotal1;
document.querySelector('feereports2-card').totalpaid=parseInt(cashcount)+parseInt(chequecount);
document.querySelector('feereports2-card').totalcash=parseInt(cashtotal1)+parseInt(cashtotal2);
document.querySelector('feereports2-card').totalcheque=parseInt(chequetotal1)+parseInt(chequetotal2);
document.querySelector('feereports2-card').totalcollection=parseInt(cashtotal1)+parseInt(cashtotal2)+parseInt(chequetotal1)+parseInt(chequetotal2);
			},




			datepickinsta1:function(e){
				this.datepickinsta1url=sessionStorage.getItem("addrinfo")+"/datepickinsta1";
				var obj={"dates":"","schol":""}

				var condate = new Date(e);
				var todate=condate.getFullYear()+"-"+(condate.getMonth()+1)+"-"+condate.getDate();
				obj.dates=todate;
				obj.schol=sessionStorage.getItem("sch");
				this.datepickinsta1param=obj;
				this.$.datepickinsta1ajax.generateRequest();
			},
			datepickinsta1Response:function(e){
				collection1 = 0;
				feeresultinsta1=e.detail.response.returnval;
				for(var i=0;i<feeresultinsta1.length;i++)
				{
					collection1 += parseInt(e.detail.response.returnval[i].installment_1);
				}
				//document.querySelector('feereports-card').feereportarr1=feeresultinsta1;
			},
			datepickinsta2:function(e){
				this.datepickinsta2url=sessionStorage.getItem("addrinfo")+"/datepickinsta2";
				var obj={"dates":"","schol":""}
				var condate = new Date(e);
				var todate=condate.getFullYear()+"-"+(condate.getMonth()+1)+"-"+condate.getDate();
				obj.dates=todate;
				obj.schol=sessionStorage.getItem("sch");
				this.datepickinsta2param=obj;
				this.$.datepickinsta2ajax.generateRequest();
			},
			datepickResponse:function(e){
				var student2time = 0;
				var collection2 = 0;
				var count = 0;
				cashcount = 0;
				total_collection_cash = 0;
				feeresultinsta2=e.detail.response.returnval;
				for(var i=0;i<feeresultinsta2.length;i++)
				{
					collection2 += parseInt(e.detail.response.returnval[i].installment_1);
				}
				if(collection1 && collection2){
					total_collection_cash = collection1 + collection2;
				} else if(collection1) {
					total_collection_cash = collection1;
				} else {
					total_collection_cash = collection2;
				}
				for(var i=0;i<feeresultinsta1.length;i++){
					for (var j = 0; j<feeresultinsta2.length;j++) {
						if(feeresultinsta1[i].student_id == feeresultinsta2[j].student_id){
							student2time += parseInt(feeresultinsta1[i].student_id);
							count++;
						}
					}
				}
				cashcount = count;
				/*if(total_collection == 0){
					document.querySelector('transport-app').setPage("nodata","Fee Reports");
				} else {*/
				var feeresultcash = [];
				if(feeresultinsta1!="")
				{
					 for(i=0;i<feeresultinsta1.length;i++)
					{
					 feeresultcash.push(feeresultinsta1[i]);
					}

			}
				 if(feeresultinsta2!="")
				{
					for(i=0;i<feeresultinsta2.length;i++)
					{
					 feeresultcash.push(feeresultinsta2[i]);
					}
			 }
				document.querySelector('feereports-card').feereportarr=feeresultcash;
				document.querySelector('feereports-card').total_collection_cash=total_collection_cash;
				//}
			},
			datepickinsta1cheque:function(e){
				this.datepickinsta1chequeurl=sessionStorage.getItem("addrinfo")+"/datepickinsta1cheque";
				var obj={"dates":"","schol":""}
				var condate = new Date(e);
				var todate=condate.getFullYear()+"-"+(condate.getMonth()+1)+"-"+condate.getDate();
				obj.dates=todate;
				 obj.schol=sessionStorage.getItem("sch");
				this.datepickinsta1chequeparam=obj;
				this.$.datepickinsta1chequeajax.generateRequest();
			},
			datepickinsta1chequeResponse:function(e){
				collection1cheque = 0;
				feeresultinsta1cheque=e.detail.response.returnval;
				for(var i=0;i<feeresultinsta1cheque.length;i++)
				{
					collection1cheque += parseInt(e.detail.response.returnval[i].installment_1);
				}
				//document.querySelector('feereports-card').feereportarr1cheque=feeresultinsta1cheque;
			},
			datepickinsta2cheque:function(e){
				this.datepickinsta2chequeurl=sessionStorage.getItem("addrinfo")+"/datepickinsta2cheque";
				var obj={"dates":"","schol":""}
				var condate = new Date(e);
				var todate=condate.getFullYear()+"-"+(condate.getMonth()+1)+"-"+condate.getDate();
				obj.dates=todate;
				 obj.schol=sessionStorage.getItem("sch");
				this.datepickinsta2chequeparam=obj;
				this.$.datepickinsta2chequeajax.generateRequest();
			},
			datepickchequeResponse:function(e){
				var collection2cheque = 0;
				var count = 0;
				var countcheque = 0;
				feeresultinsta2cheque=e.detail.response.returnval;
				for(var i=0;i<feeresultinsta2cheque.length;i++){
					collection2cheque += parseInt(e.detail.response.returnval[i].installment_1);
				}
				if(collection1cheque && collection2cheque){
					var total_collection_cheque = collection1cheque + collection2cheque;
				} else if(collection1cheque) {
					var total_collection_cheque = collection1cheque;
				} else {
					var total_collection_cheque = collection2cheque;
				}
				if(total_collection_cash && total_collection_cheque){
					var total_collection = total_collection_cheque + total_collection_cash;
				} else if(total_collection_cash){
					var total_collection = total_collection_cash;
				} else {
					var total_collection = total_collection_cheque;
				}
				if(feeresultinsta1 && feeresultinsta2){
					var students_paid_cash = feeresultinsta1.length+feeresultinsta2.length;
				} else if(feeresultinsta1) {
					var students_paid_cash = feeresultinsta1.length
				} else {
					var students_paid_cash = feeresultinsta2.length;
				}
				if(feeresultinsta1cheque && feeresultinsta2cheque){
					var students_paid_cheque = feeresultinsta1cheque.length + feeresultinsta2cheque.length;
				} else if(feeresultinsta1cheque) {
					var students_paid_cheque = feeresultinsta1cheque.length;
				} else {
					var students_paid_cheque = feeresultinsta2cheque.length;
				}
				var students_paid_by_cash = students_paid_cash - cashcount;
				for(var i=0;i<feeresultinsta1cheque.length;i++){
					for (var j = 0; j<feeresultinsta2cheque.length;j++) {
						if(feeresultinsta1cheque[i].student_id == feeresultinsta2cheque[j].student_id){
							count++;
						}
					}
				}
				chequecount = count;
				var students_paid_by_cheque = students_paid_cheque - chequecount;
				var total_students_paid = students_paid_by_cash + students_paid_by_cheque;
				//alert(collection1);
				/*if(total_collection_cheque == 0){
					document.querySelector('transport-app').setPage("nodata","Fee Reports");
				} else {*/
				var feeresultcheque = [];
				if(feeresultinsta1cheque!="")
				{
					 for(i=0;i<feeresultinsta1cheque.length;i++)
					{
					 feeresultcheque.push(feeresultinsta1cheque[i]);
					}

			}
				 if(feeresultinsta2cheque!="")
				{
					for(i=0;i<feeresultinsta2cheque.length;i++)
					{
					 feeresultcheque.push(feeresultinsta2cheque[i]);
					}
			 }
					 document.querySelector('feereports-card').feereportarrcheque=feeresultcheque;
					 document.querySelector('feereports-card').total_collection_cheque=total_collection_cheque;
					 document.querySelector('feereports-card').total_collection= total_collection;
					 document.querySelector('feereports-card').students_paid_by_cash= students_paid_by_cash;
					 document.querySelector('feereports-card').students_paid_by_cheque= students_paid_by_cheque;
					 document.querySelector('feereports-card').total_students_paid= total_students_paid;
				//}
			},
			pending:function(){
				this.pendingurl=sessionStorage.getItem("addrinfo")+"/pending";
				var obj={"schol":""}
				obj.schol=sessionStorage.getItem("sch");
				this.pendingparam=obj;
				this.$.pendingajax.generateRequest();
			},
			pendingResponse:function(e){
				var pending=e.detail.response.returnval;
				alert(JSON.stringify(pending));
				if(e.detail.response.returnval=='invalid')
				{
					 document.querySelector('transport-app').setPage("nodata","Pending Fee Report");
				}
				document.querySelector('pending-card').pendingarr=pending;
			},
			 discountbyname:function(){
			 this.discountreportbynameurl=sessionStorage.getItem("addrinfo")+"/discountbyname";
			 var obj={"schol":""}
			obj.schol=sessionStorage.getItem("sch");
			this.discountreportbynameparam=obj;
			 this.$.discountreportbynameajax.generateRequest();
			},
			discountreportbynameResponse:function(e)
			{
				var nameitem=e.detail.response.returnval;
				document.querySelector('discountstudent-card').autocompletename(nameitem);
			},
			transportcanceldetail:function()
			{
			 this.transportcancelurl=sessionStorage.getItem("addrinfo")+"/transportcancelreport";
			 var obj={"schol":"","academic_year":""}
		    obj.academic_year=localStorage.getItem("curr_sess_academicyear");
        	obj.schol=sessionStorage.getItem("sch");
			this.transportcancelparam=obj;
			 this.$.transportcancelajax.generateRequest(); 
			},
			transportcancelResponse:function(e)
			{
				var cancelarr=e.detail.response.returnval;
				//alert(JSON.stringify(cancelarr));
				document.querySelector('transportcancel-report').canceltransarr=cancelarr;
			}
		});
 })();
	</script>

</dom-module>



